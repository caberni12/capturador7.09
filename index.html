<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Capturador de Datos</title>
<link rel="stylesheet" href="style.css">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<script src="https://unpkg.com/html5-qrcode"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>




</head>

<body>
<audio id="beep">
<source src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg">
</audio>

<div class="wrap">
<div class="card">

  <div class="tabbar">
    <button class="primary" onclick="openTab('captura')">ğŸ“‹ Capturador</button>
    <button class="primary" onclick="openTab('importar')">ğŸ“¥ Importar Maestra</button>
    <button type="button" class="primary" onclick="abrirModalConsulta()">ğŸ” Consultar</button>
  </div>
  

<!-- CAPTURADOR -->
<div id="captura" class="tab active">

<h2>ğŸ“‹ Capturador PRO</h2>

<div class="total" id="totalizador">Total unidades: 0</div>

<input id="operador" placeholder="Nombre del operador" oninput="previewIngreso()">

<div class="field">
<input id="ubicacion" placeholder="UbicaciÃ³n (opcional)" oninput="previewIngreso()">
<button class="qrbtn" onclick="scanUbicacion()">ğŸ“</button>
<button class="clearbtn" onclick="limpiarUbicacion()">ğŸ§¹</button>
</div>

<div class="note">â„¹ï¸ La ubicaciÃ³n es opcional</div>

<div class="field">
 <input id="codigo" type="text" placeholder="CÃ³digo"oninput="buscarDescripcion();previewIngreso()">

 <button class="qrbtn" onclick="scanCodigo()">ğŸ“·</button>
 <button class="flashqr" onclick="toggleTorch()">ğŸ”¦</button>
</div>

<input id="descripcion" placeholder="DescripciÃ³n" oninput="previewIngreso()">
<input id="cantidad" type="number" value="1" oninput="previewIngreso()">

<div id="preview"></div>


<div id="scannerBox">
<div class="scan-frame"></div>
<div class="scan-line"></div>
<div class="scanner-controls">
<button class="ctrl success" onclick="toggleTorch()">ğŸ”¦ Linterna</button>
<button class="ctrl danger" onclick="cerrarScanner()">âŒ Cerrar</button>
</div>
</div>

<button class="primary" onclick="ingresar()">ğŸ’¾ Guardar</button>

<div class="field">
 <button class="secondary" onclick="toggleScanner()">ğŸ“· CÃ¡mara</button>
</div>
<button class="warn" onclick="cancelarEdicion()">â†©ï¸ Cancelar ediciÃ³n</button>

<div id="tabla"></div>
<button class="success" onclick="finalizar()">ğŸ“Š Finalizar y abrir Excel</button>
<button class="primary" onclick="exportarPDF()">ğŸ“„ Descargar PDF</button>

</div>

<!-- IMPORTADOR -->
<div id="importar" class="tab">

<h2>ğŸ“¥ Importar Maestra de CÃ³digos</h2>

<input type="file" id="fileExcel" accept=".xlsx">

<div class="progress"><div id="barra"></div></div>

<button class="primary" onclick="importarMaestra()">â¬†ï¸ Importar a Google Sheets</button>

<div id="mensaje" class="msg"></div>

</div>

</div>
</div>

<!-- MODAL CONSULTA -->
<div id="modalConsulta" class="modal">
  <div class="modal-card">

    <div class="modal-header">
      <b>ğŸ” Consulta de productos</b>
      <button onclick="cerrarModalConsulta()">âœ–</button>
    </div>

    <input id="buscarConsulta"
           placeholder="Buscar por cÃ³digo o descripciÃ³nâ€¦"
           oninput="filtrarConsulta()">
           <button class="primary" onclick="exportarMaestraProductos()">
            ğŸ“¤ Exportar Maestra de Productos
          </button>
          

    <!-- CONTENEDOR CON SCROLL -->
    <div class="table-scroll" id="scrollConsulta" style="display:none">
      <table id="tablaConsulta">
        <thead>
          <tr>
            <th>CÃ³digo</th>
            <th>DescripciÃ³n</th>
          </tr>
        </thead>
        <tbody id="resultadoConsulta"></tbody>
      </table>
    </div>

    <div id="msgConsulta" class="msg">Escriba para consultar</div>

  </div>
</div>




<script src="app.js"></script>

</body>
</html>